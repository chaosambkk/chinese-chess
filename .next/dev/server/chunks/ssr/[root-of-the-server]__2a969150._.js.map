{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///Users/chaosm/sm/hobby/chess/src/components/Board.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/components/Board.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/Board.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAA4R,GACzT,0DACA","ignoreList":[0]}},
    {"offset": {"line": 32, "column": 0}, "map": {"version":3,"sources":["file:///Users/chaosm/sm/hobby/chess/src/components/Board.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/components/Board.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/Board.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAwQ,GACrS,sCACA","ignoreList":[0]}},
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 54, "column": 0}, "map": {"version":3,"sources":["file:///Users/chaosm/sm/hobby/chess/src/lib/chess-engine.ts"],"sourcesContent":["import { Board, GameState, Move, Piece, PieceType, Player, Position } from '@/types/chess';\n\nexport const INITIAL_BOARD: Board = [\n    // Black pieces (top)\n    [\n        { type: 'R', player: 'black' },\n        { type: 'H', player: 'black' },\n        { type: 'E', player: 'black' },\n        { type: 'A', player: 'black' },\n        { type: 'K', player: 'black' },\n        { type: 'A', player: 'black' },\n        { type: 'E', player: 'black' },\n        { type: 'H', player: 'black' },\n        { type: 'R', player: 'black' },\n    ],\n    [null, null, null, null, null, null, null, null, null],\n    [\n        null,\n        { type: 'C', player: 'black' },\n        null,\n        null,\n        null,\n        null,\n        null,\n        { type: 'C', player: 'black' },\n        null,\n    ],\n    [\n        { type: 'P', player: 'black' },\n        null,\n        { type: 'P', player: 'black' },\n        null,\n        { type: 'P', player: 'black' },\n        null,\n        { type: 'P', player: 'black' },\n        null,\n        { type: 'P', player: 'black' },\n    ],\n    [null, null, null, null, null, null, null, null, null],\n    // River\n    [null, null, null, null, null, null, null, null, null],\n    [\n        { type: 'P', player: 'red' },\n        null,\n        { type: 'P', player: 'red' },\n        null,\n        { type: 'P', player: 'red' },\n        null,\n        { type: 'P', player: 'red' },\n        null,\n        { type: 'P', player: 'red' },\n    ],\n    [\n        null,\n        { type: 'C', player: 'red' },\n        null,\n        null,\n        null,\n        null,\n        null,\n        { type: 'C', player: 'red' },\n        null,\n    ],\n    [null, null, null, null, null, null, null, null, null],\n    [\n        { type: 'R', player: 'red' },\n        { type: 'H', player: 'red' },\n        { type: 'E', player: 'red' },\n        { type: 'A', player: 'red' },\n        { type: 'K', player: 'red' },\n        { type: 'A', player: 'red' },\n        { type: 'E', player: 'red' },\n        { type: 'H', player: 'red' },\n        { type: 'R', player: 'red' },\n    ],\n];\n\nexport const getInitialState = (): GameState => ({\n    board: JSON.parse(JSON.stringify(INITIAL_BOARD)),\n    turn: 'red',\n    lastMove: null,\n    winner: null,\n    isCheck: false,\n});\n\nexport const isValidMove = (state: GameState, move: Move): boolean => {\n    const { from, to } = move;\n    const board = state.board;\n    const piece = board[from.r][from.c];\n\n    if (!piece || piece.player !== state.turn) return false;\n\n    const target = board[to.r][to.c];\n    if (target && target.player === state.turn) return false;\n\n    const dr = to.r - from.r;\n    const dc = to.c - from.c;\n    const absDr = Math.abs(dr);\n    const absDc = Math.abs(dc);\n\n    switch (piece.type) {\n        case 'K': // King\n            if (absDr + absDc !== 1) return false;\n            // Must stay in palace\n            if (to.c < 3 || to.c > 5) return false;\n            if (piece.player === 'red' && to.r < 7) return false;\n            if (piece.player === 'black' && to.r > 2) return false;\n            break;\n\n        case 'A': // Advisor\n            if (absDr !== 1 || absDc !== 1) return false;\n            // Must stay in palace\n            if (to.c < 3 || to.c > 5) return false;\n            if (piece.player === 'red' && to.r < 7) return false;\n            if (piece.player === 'black' && to.r > 2) return false;\n            break;\n\n        case 'E': // Elephant\n            if (absDr !== 2 || absDc !== 2) return false;\n            // Cannot cross river\n            if (piece.player === 'red' && to.r < 5) return false;\n            if (piece.player === 'black' && to.r > 4) return false;\n            // Cannot be blocked (Eye of the Elephant)\n            if (board[from.r + dr / 2][from.c + dc / 2]) return false;\n            break;\n\n        case 'H': // Horse\n            if (!((absDr === 2 && absDc === 1) || (absDr === 1 && absDc === 2))) return false;\n            // Cannot be blocked (Horse leg)\n            if (absDr === 2) {\n                if (board[from.r + dr / 2][from.c]) return false;\n            } else {\n                if (board[from.r][from.c + dc / 2]) return false;\n            }\n            break;\n\n        case 'R': // Rook\n            if (dr !== 0 && dc !== 0) return false;\n            if (countPiecesBetween(board, from, to) !== 0) return false;\n            break;\n\n        case 'C': // Cannon\n            if (dr !== 0 && dc !== 0) return false;\n            const count = countPiecesBetween(board, from, to);\n            if (target) {\n                if (count !== 1) return false; // Must jump over exactly one piece to capture\n            } else {\n                if (count !== 0) return false; // Must have no pieces between to move\n            }\n            break;\n\n        case 'P': // Pawn\n            if (piece.player === 'red') {\n                if (dr > 0) return false; // Cannot move backward\n                if (from.r >= 5) {\n                    // Before crossing river\n                    if (dr !== -1 || dc !== 0) return false;\n                } else {\n                    // After crossing river\n                    if (absDr + absDc !== 1 || dr > 0) return false;\n                }\n            } else {\n                if (dr < 0) return false; // Cannot move backward\n                if (from.r <= 4) {\n                    // Before crossing river\n                    if (dr !== 1 || dc !== 0) return false;\n                } else {\n                    // After crossing river\n                    if (absDr + absDc !== 1 || dr < 0) return false;\n                }\n            }\n            break;\n    }\n\n    // Check for \"Flying General\" (King facing King)\n    // This is usually checked AFTER the move or as part of move validation\n    // But for simple move validation, we mainly care about piece movement rules.\n\n    return true;\n};\n\nconst countPiecesBetween = (board: Board, from: Position, to: Position): number => {\n    let count = 0;\n    if (from.r === to.r) {\n        const start = Math.min(from.c, to.c);\n        const end = Math.max(from.c, to.c);\n        for (let c = start + 1; c < end; c++) {\n            if (board[from.r][c]) count++;\n        }\n    } else {\n        const start = Math.min(from.r, to.r);\n        const end = Math.max(from.r, to.r);\n        for (let r = start + 1; r < end; r++) {\n            if (board[r][from.c]) count++;\n        }\n    }\n    return count;\n};\n\nexport const makeMove = (state: GameState, move: Move): GameState | null => {\n    if (!isValidMove(state, move)) return null;\n\n    const newBoard = JSON.parse(JSON.stringify(state.board));\n    const piece = newBoard[move.from.r][move.from.c];\n\n    // Handle Fly General rule check (optional but good)\n    // ...\n\n    newBoard[move.to.r][move.to.c] = piece;\n    newBoard[move.from.r][move.from.c] = null;\n\n    const nextTurn = state.turn === 'red' ? 'black' : 'red';\n\n    // Check win condition (if King is captured)\n    const target = state.board[move.to.r][move.to.c];\n    let winner = null;\n    if (target && target.type === 'K') {\n        winner = state.turn;\n    }\n\n    return {\n        ...state,\n        board: newBoard,\n        turn: nextTurn,\n        lastMove: move,\n        winner,\n    };\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 492, "column": 0}, "map": {"version":3,"sources":["file:///Users/chaosm/sm/hobby/chess/src/lib/pusher.ts"],"sourcesContent":["import PusherServer from 'pusher';\nimport PusherClient from 'pusher-js';\n\nexport const pusherServer = new PusherServer({\n    appId: process.env.PUSHER_APP_ID!,\n    key: process.env.NEXT_PUBLIC_PUSHER_KEY!,\n    secret: process.env.PUSHER_SECRET!,\n    cluster: process.env.NEXT_PUBLIC_PUSHER_CLUSTER!,\n    useTLS: true,\n});\n\nexport const getPusherClient = () => {\n    return new PusherClient(process.env.NEXT_PUBLIC_PUSHER_KEY!, {\n        cluster: process.env.NEXT_PUBLIC_PUSHER_CLUSTER!,\n    });\n};\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEO,MAAM,eAAe,IAAI,kJAAY,CAAC;IACzC,OAAO,QAAQ,GAAG,CAAC,aAAa;IAChC,KAAK,QAAQ,GAAG,CAAC,sBAAsB;IACvC,QAAQ,QAAQ,GAAG,CAAC,aAAa;IACjC,SAAS,QAAQ,GAAG,CAAC,0BAA0B;IAC/C,QAAQ;AACZ;AAEO,MAAM,kBAAkB;IAC3B,OAAO,IAAI,iKAAY,CAAC,QAAQ,GAAG,CAAC,sBAAsB,EAAG;QACzD,SAAS,QAAQ,GAAG,CAAC,0BAA0B;IACnD;AACJ"}},
    {"offset": {"line": 518, "column": 0}, "map": {"version":3,"sources":["file:///Users/chaosm/sm/hobby/chess/src/hooks/useStats.ts"],"sourcesContent":["import { useState, useEffect } from 'react';\n\ninterface Stats {\n    wins: number;\n    losses: number;\n    draws: number;\n}\n\nexport function useStats(side: 'red' | 'black' | null) {\n    const [stats, setStats] = useState<Stats>({ wins: 0, losses: 0, draws: 0 });\n\n    useEffect(() => {\n        const saved = localStorage.getItem('chess_stats');\n        if (saved) {\n            setStats(JSON.parse(saved));\n        }\n    }, []);\n\n    const addWin = () => {\n        const newStats = { ...stats, wins: stats.wins + 1 };\n        setStats(newStats);\n        localStorage.setItem('chess_stats', JSON.stringify(newStats));\n    };\n\n    const addLoss = () => {\n        const newStats = { ...stats, losses: stats.losses + 1 };\n        setStats(newStats);\n        localStorage.setItem('chess_stats', JSON.stringify(newStats));\n    };\n\n    const addDraw = () => {\n        const newStats = { ...stats, draws: stats.draws + 1 };\n        setStats(newStats);\n        localStorage.setItem('chess_stats', JSON.stringify(newStats));\n    };\n\n    return { stats, addWin, addLoss, addDraw };\n}\n"],"names":[],"mappings":";;;;AAAA;;AAQO,SAAS,SAAS,IAA4B;IACjD,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAQ;QAAE,MAAM;QAAG,QAAQ;QAAG,OAAO;IAAE;IAEzE,IAAA,kNAAS,EAAC;QACN,MAAM,QAAQ,aAAa,OAAO,CAAC;QACnC,IAAI,OAAO;YACP,SAAS,KAAK,KAAK,CAAC;QACxB;IACJ,GAAG,EAAE;IAEL,MAAM,SAAS;QACX,MAAM,WAAW;YAAE,GAAG,KAAK;YAAE,MAAM,MAAM,IAAI,GAAG;QAAE;QAClD,SAAS;QACT,aAAa,OAAO,CAAC,eAAe,KAAK,SAAS,CAAC;IACvD;IAEA,MAAM,UAAU;QACZ,MAAM,WAAW;YAAE,GAAG,KAAK;YAAE,QAAQ,MAAM,MAAM,GAAG;QAAE;QACtD,SAAS;QACT,aAAa,OAAO,CAAC,eAAe,KAAK,SAAS,CAAC;IACvD;IAEA,MAAM,UAAU;QACZ,MAAM,WAAW;YAAE,GAAG,KAAK;YAAE,OAAO,MAAM,KAAK,GAAG;QAAE;QACpD,SAAS;QACT,aAAa,OAAO,CAAC,eAAe,KAAK,SAAS,CAAC;IACvD;IAEA,OAAO;QAAE;QAAO;QAAQ;QAAS;IAAQ;AAC7C"}},
    {"offset": {"line": 571, "column": 0}, "map": {"version":3,"sources":["file:///Users/chaosm/sm/hobby/chess/src/app/page.tsx"],"sourcesContent":["import Board from '@/components/Board';\nimport { getInitialState, makeMove as engineMakeMove } from '@/lib/chess-engine';\nimport { Move, GameState } from '@/types/chess';\nimport { getPusherClient } from '@/lib/pusher';\nimport { useStats } from '@/hooks/useStats';\n\nexport default function GamePage() {\n  const [gameState, setGameState] = useState<GameState>(getInitialState());\n  const [playerSide, setPlayerSide] = useState<'red' | 'black' | null>(null);\n  const [gameId, setGameId] = useState<string | null>(null);\n  const [isCopied, setIsCopied] = useState(false);\n  const { stats, addWin, addLoss } = useStats(playerSide);\n\n  // Initialize Game ID from URL hash or generate new one\n  useEffect(() => {\n    const hash = window.location.hash.replace('#', '');\n    if (hash) {\n      setGameId(hash);\n    } else {\n      const newId = Math.random().toString(36).substring(2, 9);\n      setGameId(newId);\n      window.location.hash = newId;\n    }\n  }, []);\n\n  // Subscribe to Pusher channel\n  useEffect(() => {\n    if (!gameId) return;\n\n    const pusher = getPusherClient();\n    const channel = pusher.subscribe(`game-${gameId}`);\n\n    channel.bind('move-made', (data: { move: Move; state: GameState }) => {\n      setGameState(data.state);\n\n      // Update stats if game ended\n      if (data.state.winner) {\n        if (playerSide === data.state.winner) {\n          addWin();\n        } else if (playerSide && playerSide !== data.state.winner) {\n          addLoss();\n        }\n      }\n    });\n\n    return () => {\n      pusher.unsubscribe(`game-${gameId}`);\n    };\n  }, [gameId, playerSide, addWin, addLoss]);\n\n  const handleMove = async (move: Move) => {\n    // Prevent moving if it's not our turn (in multiplayer mode)\n    if (playerSide && gameState.turn !== playerSide) return;\n\n    const nextState = engineMakeMove(gameState, move);\n    if (nextState) {\n      setGameState(nextState);\n\n      // Broadcast move via API\n      if (gameId) {\n        try {\n          await fetch('/api/move', {\n            method: 'POST',\n            body: JSON.stringify({ move, state: nextState, gameId }),\n            headers: { 'Content-Type': 'application/json' },\n          });\n        } catch (error) {\n          console.error('Failed to broadcast move:', error);\n        }\n      }\n    }\n  };\n\n  const copyLink = () => {\n    navigator.clipboard.writeText(window.location.href);\n    setIsCopied(true);\n    setTimeout(() => setIsCopied(false), 2000);\n  };\n\n  if (!gameId) return <div className=\"min-h-screen bg-neutral-900 flex items-center justify-center text-white\">Ê≠£Âú®ÂàùÂßãÂåñ...</div>;\n\n  return (\n    <main className=\"min-h-screen bg-neutral-900 text-white flex flex-col items-center justify-center p-4\">\n      <div className=\"max-w-4xl w-full flex flex-col gap-8\">\n        <header className=\"flex flex-col md:flex-row gap-4 justify-between items-center bg-neutral-800 p-6 rounded-xl shadow-lg border border-neutral-700\">\n          <div>\n            <h1 className=\"text-3xl font-extrabold tracking-tight bg-gradient-to-r from-red-500 to-amber-500 bg-clip-text text-transparent\">\n              ‰∏≠ÂõΩË±°Ê£ã\n            </h1>\n            <p className=\"text-neutral-400\">Ê∏∏Êàè ID: <span className=\"text-amber-500 font-mono\">{gameId}</span></p>\n          </div>\n\n          <div className=\"flex flex-wrap gap-4 items-center justify-center\">\n            {!playerSide ? (\n              <div className=\"flex gap-2 bg-neutral-700 p-1 rounded-lg\">\n                <button onClick={() => setPlayerSide('red')} className=\"px-4 py-2 bg-red-600 hover:bg-red-500 rounded-md transition-colors\">ÊàëÊòØÁ∫¢Êñπ</button>\n                <button onClick={() => setPlayerSide('black')} className=\"px-4 py-2 bg-neutral-900 hover:bg-neutral-800 rounded-md transition-colors\">ÊàëÊòØÈªëÊñπ</button>\n              </div>\n            ) : (\n              <div className=\"bg-neutral-700 px-4 py-2 rounded-lg border border-neutral-600\">\n                <span className=\"text-neutral-400 text-sm block\">ÊàëÁöÑË∫´‰ªΩ</span>\n                <span className={playerSide === 'red' ? 'text-red-500 font-bold' : 'text-white font-bold'}>\n                  {playerSide === 'red' ? 'üî¥ Á∫¢Êñπ' : '‚ö´ ÈªëÊñπ'}\n                </span>\n              </div>\n            )}\n\n            <button\n              onClick={copyLink}\n              className=\"bg-amber-600 hover:bg-amber-500 text-white px-4 py-2 rounded-lg transition-colors flex items-center gap-2\"\n            >\n              {isCopied ? 'Â∑≤Â§çÂà∂ÔºÅ' : 'ÂàÜ‰∫´ÈìæÊé•ÁªôÂÆ∂‰∫∫'}\n            </button>\n          </div>\n        </header>\n\n        <section className=\"flex justify-center p-4 md:p-8 bg-neutral-800 rounded-2xl shadow-2xl border border-neutral-700 relative overflow-hidden\">\n          <div className=\"absolute top-0 left-0 w-full h-full opacity-5 pointer-events-none\">\n            <div className=\"absolute top-10 left-10 w-64 h-64 rounded-full bg-red-500 blur-3xl\"></div>\n            <div className=\"absolute bottom-10 right-10 w-64 h-64 rounded-full bg-amber-500 blur-3xl\"></div>\n          </div>\n\n          <Board\n            gameState={gameState}\n            onMove={handleMove}\n            playerSide={playerSide || 'red'}\n          />\n        </section>\n\n        <footer className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          <div className=\"bg-neutral-800 p-4 rounded-xl border border-neutral-700\">\n            <h3 className=\"text-neutral-400 text-sm mb-2 uppercase tracking-wider\">ÊÄé‰πàÁé©Ôºü</h3>\n            <p className=\"text-sm text-neutral-400\">\n              1. ÁÇπÂáª‚ÄúÊàëÊòØÁ∫¢Êñπ‚ÄùÊàñ‚ÄúÊàëÊòØÈªëÊñπ‚ÄùÈÄâÊã©ÈòµËê•„ÄÇ<br />\n              2. Â§çÂà∂È°µÈù¢ÈìæÊé•ÂèëÈÄÅÁªôÂ≠©Â≠êÔºåÂ≠©Â≠êÊâìÂºÄÂêéÈÄâÊã©Âè¶‰∏Ä‰∏™ÈòµËê•„ÄÇ<br />\n              3. Á∫¢ÊñπÂÖàÊâãÔºåÂÆûÊó∂ÂØπÂºà„ÄÇ\n            </p>\n          </div>\n          <div className=\"bg-neutral-800 p-4 rounded-xl border border-neutral-700 flex justify-between items-center\">\n            <div>\n              <h3 className=\"text-neutral-400 text-sm mb-2 uppercase tracking-wider\">ÂÆûÊó∂ÂêåÊ≠•</h3>\n              <div className=\"flex items-center gap-2\">\n                <div className=\"w-3 h-3 bg-green-500 rounded-full animate-pulse\"></div>\n                <span className=\"text-green-500\">Pusher Â∑≤Â∞±Áª™</span>\n              </div>\n            </div>\n            <button\n              onClick={() => setGameState(getInitialState())}\n              className=\"text-neutral-500 hover:text-white text-sm underline\"\n            >\n              ÈáçÁΩÆÊ£ãÂ±Ä\n            </button>\n          </div>\n        </footer>\n      </div>\n    </main>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}